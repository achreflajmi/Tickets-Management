<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>New Customer List - Bootdey.com</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
    integrity="KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g=="
    crossorigin="anonymous">
  <style>

  </style>
</head>

<body>
  <div class="containerheader">
    <app-header></app-header>
  </div>
  
  <section class="background-radial-gradient overflow-hidden d-flex align-items-center min-vh-100">
    <div class="container d-flex">
      <!-- Filter Section -->
      <div class="filter-section col-md-4">
        <div class="mb-2 position-relative">
          <i class="fa fa-filter filter-icon"></i>
          <select id="statusFilter" class="form-select" [(ngModel)]="selectedStatus" (change)="filterTickets()">
            <option value="" disabled selected hidden>Status</option>
            <option value="">All</option>
            <option value="New">New</option>
            <option value="InProgress">In Progress</option>
            <option value="Resolved">Resolved</option>
            <option value="Closed">Closed</option>
          </select>
        </div>
      
        <div class="mb-2 position-relative">
          <i class="fa fa-star filter-icon"></i>
          <select id="priorityFilter" class="form-select" [(ngModel)]="selectedPriority" (change)="filterTickets()">
            <option value="" disabled selected hidden>Priority</option>
            <option value="">All</option>
            <option value="LOW">Low</option>
            <option value="MEDIUM">Medium</option>
            <option value="HIGH">High</option>
          </select>
        </div>
      
        <div class="mb-2 position-relative">
          <i class="fa fa-calendar-alt filter-icon"></i>
          <input 
            type="date" 
            id="dateFilter" 
            class="form-control" 
            [(ngModel)]="selectedDate" 
            (change)="filterTickets()"
            placeholder="Opening Date"
          />
        </div>
      </div>
      
      
      
      <!-- Add Ticket Button -->
      <div class="add-ticket-container">
        <button class="btn btn-add-ticket" (click)="openAddTicketDialog()">
          <i class="fa fa-plus" aria-hidden="true"></i> Add Ticket
        </button>
      </div>
      
      <!-- Ticket List -->
      <div class="ticket-list col-md-4">
        <input 
          type="text" 
          class="form-control mb-3" 
          placeholder="Search by subject..." 
          [(ngModel)]="searchQuery" 
          (input)="filterTickets()"
        />
        
        <div *ngFor="let ticket of filteredTickets" class="ticket-item" (click)="onSelectTicket(ticket)">
          <div class="ticket-details">
            <p>
 {{ ticket.subject }}
              <i class="priority-icon"
                [ngClass]="{
                  'priority-high': ticket.priority === 'HIGH',
                  'priority-medium': ticket.priority === 'MEDIUM',
                  'priority-low': ticket.priority === 'LOW'
                }">
              </i>
            </p>
            <span class="status {{ ticket.status | lowercase }}">{{ ticket.status }}</span>
          </div>
          <div class="actions">
            <button class="btn btn-link p-0" (click)="openPopup(ticket)">
              <i class="fa fa-eye" aria-hidden="true"></i>
            </button>
            <button class="btn btn-link p-0" (click)="closeTicket(ticket.id)">
              <i class="fa"
                [ngClass]="{'fa-lock': ticket.status === 'Closed', 'fa-lock-open': ticket.status !== 'Closed'}">
              </i>
            </button>
          </div>
        </div>

        <div *ngIf="filteredTickets.length === 0">
          <div class="text-center">No tickets found.</div>
        </div>
      </div>

      <!-- Divider Line -->
      <div class="divider"></div>

      <!-- Chat Section -->
      <div class="chat-section col-md-8" *ngIf="selectedTicket">
        <app-ticket-details [ticket]="selectedTicket"></app-ticket-details>
        <app-chat [ticketId]="selectedTicket.id" [ticketStatus]="selectedTicket.status"></app-chat>
      </div>
    </div>
  </section>
</body>

</html>
